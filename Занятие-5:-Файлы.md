# На прошлом занятии
* Списки и операции над ними
* индексы и срезы
* вложенные циклы

# План этого занятия
* Строки: разбиение и некоторые другие операции
* Чтение и запись файлов

# Разбиение строк

Мы уже видели, что разбить строку на символы можно с помощью функции `list()`:

```python
string = "Hello"
characters = list(string)
```

А как разбить строку на отдельные слова? Для этого у строки есть специальный метод `split`, который возвращает список подстрок:

```python
cities = "Москва Санкт-Петербург Казань Тверь Иркутск"
words = cities.split()    # ["Москва", "Санкт-Петербург", "Казань", "Тверь", "Иркутск"]
```

По-умолчанию `split()` делит строку по пробелам, символам табуляции и переноса строки. Кроме того, при таком вызове `split()`, в результирующий список не входят пустые строки.

Если указать строку в качестве аргумента `split`, то вместо пробельных символов разбиение будет проходить по этой строке.

```python
pancake = "молоко,яйца,мука,сметана"
pancake_ingredients = pancake.split(',')    # ["молоко", "яйца", "мука", "сметана"]
burger = "котлета, булочка, кетчуп, салат"
# Здесь мы должны использовать разбиение по строке из двух символов: запятой и пробелу, чтобы в начале полученных строк не осталось пробелов:
buger_ingredients = burger.split(', ')    # ["котлета", "булочка", "кетчуп", "салат"]
```

Обратите внимание, что при ручном указании строки-разделителя, пустые строки не выбрасываются:

```python
coffee = "арабика    робуста  либерика"
varieties = coffee.split()    # ["арабика",    "робуста",  "либерика"]
splited_by_space = coffee.split(" ")    # ["арабика", "", "", "", "робуста", "", "либерика"]
tea = "black,white,,green"
varieties = tea.split(",")    # ["black", "white", "", "green"]
```

# Чтение и запись файлов файлов

## Запись

Пока нам читать нечего, поэтому давайте сами создадим какой-нибудь файл. Открыть файл для записи нам поможет функция `open(filename, mode)`, где `filename` — это строка с именем файлом (а точнее с его системным расположением), `mode` — это строка с описанием режима открытия файла, для записи нужно указать `"w"` — write.

```python
f = open("text.txt", "w")
f.write("Текст с Яндекс.Рефератов\n")    # записано в файл, "\n" - символ переноса строки
f.write("""Альтиметр редуцирует лазерный ньютонометр. Как отмечает А.А.Потебня,
строфоид начинает период. Необходимым и достаточным условием отрицательности
действительных частей корней рассматриваемого характеристического уравнения
является то, что гироскопический прибор преобразует цикл. Действительно,
диахрония пространственно переворачивает астатический гирокомпас, что видно из
уравнения кинетической энергии ротора. Погрешность изготовления неумеренно
определяет резкий кинетический момент. Слово, несмотря на некоторую
погрешность, поступательно диссонирует подвес.
""")    # тройные кавычки позволяют создавать многострочные "строки"
f.close()    # теперь писать в файл не получится
```

Обязательно нужно закрыть файл, это как помыть руки перед едой! Иначе другим программам операционная система может запретить доступ к этому файлу. Для того, чтобы не забывать закрывать файлы, придуман специальный блок-мойдодыр `with`, который сам закроет наш файл. Принято пользоваться именно им для работы с файлами.

```python
with open("text.txt", "w") as f:
    f.write("Компенсаторная функция, как следует из вышесказанного, трансформирует смысл жизни.\n")
# После выхода из блока писать в файл уже нельзя, следующая строка вызовет ошибку. Как всегда следите за отступами!
f.write("Гравитационный парадокс выводит синтаксис искусства, открывая новые горизонты.\n")
```

Последний блок кода перепишет уже имеющийся файл, если вы хотите дописать в конец файла, вместо `"w"` укажите `"a"` — append.

```python
with open("text.txt", "a") as f:    # создаст файл или будет дописывать в уже имеющийся
    f.writelines([
        "Познание текста, согласно традиционным представлениям, композиционно.\n",
        "Как мы уже знаем, форшлаг заканчивает неизменный зачин, благодаря употреблению микромотивов (нередко из одного звука, а также двух-трех с паузами). ",
        "Симулякр, в том числе, изменяем.\n",
    ])    # записываем список строк
```

## Чтение

Чтение происходит очень похожим образом, но в `open` вместо `"w"` используется `"r"` или режим работы вовсе не указывается:

```python
with open("text.txt", "r") as f:
    text = f.read())   # по-умолчанию .read() читает файл целиком
    splited_text = text.split()    # список из слов, иногда с "прилипшими" знаками препинания
```

Вместо того, чтобы прочесть файл в одну большую строку, включающую символы переноса строки, можно прочесть его в список отдельных строк:

```python
with open("text.txt") as f:
    lines = f.readlines()   # список из строк, каждая, быть может кроме последней, заканчивается символом переноса строки

with open("text.txt") as f:
    text = f.read()
# Выходим из блока with ... as, больше читать из файла нечего
lines = text.splitlines()    # список из строк, символы перевода строки отброшены
```

Может быть полезно читать файл по одной строке. Это можно сделать в цикле `for`:

```python
with open("text.txt") as f:
    for line in f:    # здесь строки тоже заканчиваются на символ переноса строки
        if line.endswith("\n"):
            print("Строка кончается на символ переноса строки")
        else:
            print("Строка не заканчивается на символ переноса строки")
        line = line.strip()    # удаляем пробельные символы, в том числе перенос строки, сначала и сконца строки
        if not line.endswith("\n"):
            print("Теперь переноса строки точно нет")
        if line.startswith("Давным-давно"):    # проверяем не начинается ли строка с данной строки
            print("И жили они долго и счастливо")
```

## Пример. Удаление запятых

Пусть дан файл `text.txt`, а требуется создать файл `commaless_text.txt`, который будет содержать тот же текст, но без запятых.

```python
with open("text.txt") as f:
    text = f.read()
# Лучше не делать лишних операций пока файл открыт, а поскорее закрыть его
text = text.replace(",", "")    # заменяем одну подстроку на другую
with open("comaless_text.txt", "w") as f:
    f.write(text)
```

Подумайте как можно улучшить этот код на случай, если вы правите очень большой файл и его не удастся загрузить целиком в оперативную память компьютера.

# На чём можно потренироваться?

## Предложения
Попробуйте поделить текст, взятый из файла на отдельные предложения. Учтите, что предложение может занимать несколько строк.

## Статистика
* Посчитайте число гласных и согласных в тексте.
* Посчитайте сколько раз в тексте встретился предлог «под» или любой другой.

# Домашнее задание

Программа должна открывать файл с русским текстом в utf-8 и сообщать про него следующую информацию (по вариантам):
1. чему равно среднее число слов в строке;
2. во сколько раз самая короткая строка короче самой длинной;
3. во сколько раз слов длины 3 больше, чем слов длины 1 (если слов длины 1 нет вообще, программа должна об этом сообщить);
4. какой процент от общего количества слов не оканчивается знаком препинания (можно взять только запятую и точку);
5. какой процент слов имеет длину больше 10 символов;
6. какой процент слов начинается с большой буквы;
7. какой процент строк содержит больше 5 слов.